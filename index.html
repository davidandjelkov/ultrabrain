<!DOCTYPE html>
<html lang="en">
<head>
  <meta name="google-site-verification" content="MUtnNwIKI1AhNQyPDmkOKmP04T8XqnKc30Z13aKrYmo" />
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Free IQ Test - Measure Your Intelligence Online</title>
  <meta name="description" content="Take our free professional IQ test and get instant results. Discover your intelligence quotient with accurate assessment and detailed analysis.">
  <meta name="keywords" content="IQ test, intelligence test, free IQ test, online IQ test, intelligence quotient, brain test">
  <meta name="author" content="IQ Test App">
  <meta name="robots" content="index, follow">
  
  <!-- Open Graph / Facebook -->
  <meta property="og:type" content="website">
  <meta property="og:title" content="ğŸ§  Free IQ Test - Test Your Intelligence Online">
  <meta property="og:description" content="ğŸ§ ğŸ”¥ TESTIRAJ SVOJU INTELIGENCIJU! ğŸ”¥ğŸ§  ğŸ† Besplatan IQ test sa trenutnim rezultatima! ğŸ¤” Da li imate visok IQ? Otkrijte BESPLATNO!">
  <meta property="og:image" content="images/congrats.png" id="og-image">
  <meta property="og:image:width" content="1200">
  <meta property="og:image:height" content="630">
  <meta property="og:image:type" content="image/png">
  <meta property="og:url" content="https://your-domain.com">
  
  <!-- Twitter -->
  <meta property="twitter:card" content="summary_large_image">
  <meta property="twitter:title" content="ğŸ§  Free IQ Test - Test Your Intelligence Online">
  <meta property="twitter:description" content="ğŸ§ ğŸ”¥ TESTIRAJ SVOJU INTELIGENCIJU! ğŸ”¥ğŸ§  ğŸ† Besplatan IQ test sa trenutnim rezultatima! ğŸ¤” Da li imate visok IQ? Otkrijte BESPLATNO!">
  <meta property="twitter:image" content="images/iqscore.png">

  
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link rel="preconnect" href="https://cdnjs.cloudflare.com">
  <link rel="icon" type="image/svg+xml" href="favicon.svg">
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@900&display=swap" rel="stylesheet">
  <link rel="preload" href="style.css" as="style">
  <link rel="stylesheet" href="style.css" />
  <style>
    /* Mobile hamburger menu */
    @media (max-width: 768px) {
      #mobile-menu-btn {
        display: block !important;
      }
      
      #mobile-menu {
        display: none;
      }
      
      #mobile-menu.active {
        display: block !important;
      }
      
      /* Hide auth buttons on mobile */
      #auth-buttons {
        display: none !important;
      }
      
      /* Hide search on mobile */
      .search-container {
        display: none !important;
      }
      
      /* Hide user panel on mobile */
      #user-panel {
        display: none !important;
      }
      
      /* Add top padding to container on mobile for hamburger button */
      .container {
        padding-top: 60px !important;
      }
      
      /* Hide header title on mobile */
      .header-banner .banner-title {
        display: none !important;
      }
      
      /* Show mobile title on mobile */
      #mobile-title {
        display: block !important;
      }
      

    }
  </style>
</head>
<body>
  <div class="header-banner">

    <div class="header-left">
      <div class="search-container">
        <input type="text" class="search-field" placeholder="ğŸ” Search..." oninput="showSearchSuggestions(this.value)" onkeypress="if(event.key==='Enter') window.location.href='search.html?q='+this.value">
        <div class="search-dropdown" id="searchDropdown"></div>
      </div>
      <div id="auth-buttons">
        <button onclick="showRegister()" class="auth-btn">Register</button>
        <button onclick="showLogin()" class="auth-btn">Login</button>
      </div>
      <div id="user-panel" style="display:none; color:#000; position:relative; margin-top:15px;">
        <div onclick="toggleAccountMenu()" style="cursor:pointer; padding:8px 12px; border:2px solid #ffd700; border-radius:6px; background:rgba(26,26,46,0.8);">
          ğŸ‘¤ <span id="user-email" style="color:#ffd700;"></span> â–¼
        </div>
        <div id="account-menu" style="display:none; position:absolute; top:100%; left:0; background:rgba(26,26,46,0.95); border:2px solid #ffd700; border-radius:6px; min-width:120px; z-index:1000; margin-top:5px;">
          <div onclick="window.location.href='account.html'" style="padding:10px 15px; color:#ffd700; cursor:pointer; border-bottom:1px solid rgba(255,215,0,0.2);" onmouseover="this.style.background='rgba(255,215,0,0.2)'" onmouseout="this.style.background='transparent'">
            ğŸ‘¤ Account
          </div>
          <div id="admin-panel-option" onclick="window.location.href='admin.html'" style="display:none; padding:10px 15px; color:#ffd700; cursor:pointer; border-bottom:1px solid rgba(255,215,0,0.2);" onmouseover="this.style.background='rgba(255,215,0,0.2)'" onmouseout="this.style.background='transparent'">
            ğŸ‘‘ Admin Panel
          </div>
          <div onclick="logout()" style="padding:10px 15px; color:white; cursor:pointer; border-bottom:1px solid rgba(255,215,0,0.2); background:#dc3545;" onmouseover="this.style.background='#c82333'" onmouseout="this.style.background='#dc3545'">
            ğŸšª Logout
          </div>
        </div>
      </div>
    </div>
    <h1 class="banner-title" onclick="goToHome()" style="cursor: pointer;">ğŸ§  <span class="iq-red">IQ</span> <span class="test-blue">TEST</span></h1>
  </div>
  
  <div id="mobile-menu" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.9); z-index:1000; padding:60px 20px;">
    <button onclick="toggleMobileMenu()" style="position:absolute; top:15px; right:15px; background:rgba(255,215,0,0.9); color:#000; border:2px solid #ffd700; padding:8px; border-radius:5px; cursor:pointer; font-size:16px;">âœ•</button>
    <div style="display:flex; flex-direction:column; gap:15px; align-items:center; margin-top:40px;">
      <div style="width:250px; margin-bottom:10px;">
        <input type="text" placeholder="ğŸ” Search..." oninput="showMobileSearchSuggestions(this.value)" onkeypress="if(event.key==='Enter') { window.location.href='search.html?q='+this.value; toggleMobileMenu(); }" style="width:100%; padding:12px; border:2px solid #ffd700; border-radius:8px; background:#333; color:white; font-size:16px;">
        <div id="mobile-search-dropdown" style="display:none; background:#333; border:2px solid #ffd700; border-top:none; border-radius:0 0 8px 8px; max-height:200px; overflow-y:auto;"></div>
      </div>
      <button onclick="showRegister(); toggleMobileMenu();" style="background:#28a745; color:white; border:none; padding:12px 20px; border-radius:8px; cursor:pointer; font-size:16px; width:200px;">ğŸ“ Register</button>
      <button onclick="showLogin(); toggleMobileMenu();" style="background:#007bff; color:white; border:none; padding:12px 20px; border-radius:8px; cursor:pointer; font-size:16px; width:200px;">ğŸ” Login</button>
      <button onclick="window.location.href='account.html'; toggleMobileMenu();" style="background:rgba(255,215,0,0.9); color:#000; border:2px solid #ffd700; padding:12px 20px; border-radius:8px; cursor:pointer; font-size:16px; width:200px;">ğŸ‘¤ Account</button>
      <button onclick="window.location.href='admin.html'; toggleMobileMenu();" style="background:#dc3545; color:white; border:none; padding:12px 20px; border-radius:8px; cursor:pointer; font-size:16px; width:200px;">ğŸ‘‘ Admin Panel</button>
      <button onclick="window.location.href='leaderboard.html'; toggleMobileMenu();" style="background:#ffd700; color:#000; border:none; padding:12px 20px; border-radius:8px; cursor:pointer; font-size:16px; width:200px;">ğŸ† Leaderboard</button>
    </div>
  </div>
  <div class="main-content">
    <div class="left-banner"></div>
    <div class="container" style="position:relative;">
      <button id="mobile-menu-btn" onclick="toggleMobileMenu()" style="display:none; position:absolute; top:10px; right:10px; background:rgba(255,215,0,0.9); color:#000; border:2px solid #ffd700; padding:8px; border-radius:5px; cursor:pointer; font-size:16px; z-index:999;">â˜°</button>
      <div id="start-screen">
      <h1 id="mobile-title" class="banner-title" style="display:none; text-align:center; margin-bottom:30px;">ğŸ§  <span class="iq-red">IQ</span> <span class="test-blue">TEST</span></h1>
      <button id="start-btn">Start Test</button>
      
      <div class="brain-training">
        <h3>Brain Training Exercises</h3>
        <p>Improve your IQ with these daily exercises:</p>
        
        <div class="exercises-grid">
          <div class="exercise-card" onclick="window.location.href='memory-training.html'" style="background-image:url('images/1n.jpeg'); background-size:cover; background-position:center; position:relative; cursor:pointer;">
            <div style="position:absolute; top:0; left:0; right:0; bottom:0; background-image:url('images/1n.jpeg'); background-size:cover; background-position:center; opacity:0.3; border-radius:12px;"></div>
            <div style="position:relative; z-index:2;">
              <div class="exercise-icon"></div>
              <h4>Memory Training</h4>
              <p>Enhance working memory</p>
            </div>
          </div>
          
          <div class="exercise-card" onclick="window.location.href='logic-puzzles.html'" style="background-image:url('images/2n.jpeg'); background-size:cover; background-position:center; position:relative; cursor:pointer;">
            <div style="position:absolute; top:0; left:0; right:0; bottom:0; background:rgba(255,255,255,0.3); border-radius:12px;"></div>
            <div style="position:relative; z-index:2;">
              <div class="exercise-icon"></div>
              <h4>Logic Puzzles</h4>
              <p>Boost logical reasoning</p>
            </div>
          </div>
          
          <div class="exercise-card" onclick="window.location.href='pattern-recognition.html'" style="background-image:url('images/3n.jpeg'); background-size:cover; background-position:center; position:relative; cursor:pointer;">
            <div style="position:absolute; top:0; left:0; right:0; bottom:0; background:rgba(255,255,255,0.3); border-radius:12px;"></div>
            <div style="position:relative; z-index:2;">
              <div class="exercise-icon"></div>
              <h4>Pattern Recognition</h4>
              <p>Improve visual processing</p>
            </div>
          </div>
          
          <div class="exercise-card" onclick="window.location.href='reaction-time.html'" style="background-image:url('images/4n.jpeg'); background-size:cover; background-position:center; position:relative; cursor:pointer;">
            <div style="position:absolute; top:0; left:0; right:0; bottom:0; background:rgba(255,255,255,0.3); border-radius:12px;"></div>
            <div style="position:relative; z-index:2;">
              <div class="exercise-icon"></div>
              <h4>Reaction Time</h4>
              <p>Test your reflexes</p>
            </div>
          </div>
          
          <div class="exercise-card" onclick="window.location.href='formula-racing.html'" style="background-image:url('images/5n.jpeg'); background-size:cover; background-position:center; position:relative; cursor:pointer;">
            <div style="position:absolute; top:0; left:0; right:0; bottom:0; background:rgba(255,255,255,0.3); border-radius:12px;"></div>
            <div style="position:relative; z-index:2;">
              <div class="exercise-icon"></div>
              <h4>Formula Racing</h4>
              <p>Speed and reflexes</p>
            </div>
          </div>
          
          <div class="exercise-card" onclick="window.location.href='number-merge.html'" style="background-image:url('images/6n.jpeg'); background-size:cover; background-position:center; position:relative; cursor:pointer;">
            <div style="position:absolute; top:0; left:0; right:0; bottom:0; background:rgba(255,255,255,0.3); border-radius:12px;"></div>
            <div style="position:relative; z-index:2;">
              <div class="exercise-icon"></div>
              <h4>Number Merge</h4>
              <p>Combine numbers to reach 2048</p>
            </div>
          </div>
          
          <div class="exercise-card" onclick="window.location.href='sudoku-puzzle.html'" style="background-image:url('images/7n.jpeg'); background-size:cover; background-position:center; position:relative; cursor:pointer;">
            <div style="position:absolute; top:0; left:0; right:0; bottom:0; background:rgba(255,255,255,0.3); border-radius:12px;"></div>
            <div style="position:relative; z-index:2;">
              <div class="exercise-icon"></div>
              <h4>Sudoku</h4>
              <p>Classic number puzzle game</p>
            </div>
          </div>
          
          <div class="exercise-card" onclick="window.location.href='tetris-blocks.html'" style="background-image:url('images/8n.jpeg'); background-size:cover; background-position:center; position:relative; cursor:pointer;">
            <div style="position:absolute; top:0; left:0; right:0; bottom:0; background:rgba(255,255,255,0.3); border-radius:12px;"></div>
            <div style="position:relative; z-index:2;">
              <div class="exercise-icon"></div>
              <h4>Tetris</h4>
              <p>Block stacking puzzle</p>
            </div>
          </div>
          
          <div class="exercise-card" onclick="openExercise('mythology')" style="background-image:url('images/9n.jpeg'); background-size:cover; background-position:center; position:relative;">
            <div style="position:absolute; top:0; left:0; right:0; bottom:0; background:rgba(255,255,255,0.3); border-radius:12px;"></div>
            <div style="position:relative; z-index:2;">
              <div class="exercise-icon"></div>
              <h4>Age of Mythology Advanced</h4>
              <p>Epic RTS with ages & tech</p>
            </div>
          </div>
          
          <div class="exercise-card" onclick="window.location.href='gladiator-arena.html'" style="background: linear-gradient(45deg, #8B4513, #654321); position:relative; cursor:pointer;">
            <div style="position:absolute; top:0; left:0; right:0; bottom:0; background:rgba(255,255,255,0.1); border-radius:12px;"></div>
            <div style="position:relative; z-index:2;">
              <div class="exercise-icon">âš”ï¸</div>
              <h4>Gladiator Arena</h4>
              <p>3D battle arena combat</p>
            </div>
          </div>
          
          <div class="exercise-card" onclick="window.location.href='highway-3d.html'" style="background: linear-gradient(45deg, #1e3c72, #2a5298); position:relative; cursor:pointer;">
            <div style="position:absolute; top:0; left:0; right:0; bottom:0; background:rgba(255,255,255,0.1); border-radius:12px;"></div>
            <div style="position:relative; z-index:2;">
              <div class="exercise-icon">ğŸï¸</div>
              <h4>Highway 3D</h4>
              <p>3D racing with Three.js</p>
            </div>
          </div>
          


        </div>
      </div>
      
      <div class="iq-magazine">
        <h3>ğŸ“š IQ Magazine</h3>
        <p>Articles about brain, intelligence and mental improvement</p>
        
        <div class="magazine-grid">
          <div class="exercise-card" onclick="openMagazine()" style="background-image:url('images/magazin.png'); background-size:50%; background-position:center; position:relative; cursor:pointer;">
            <div style="position:absolute; top:0; left:0; right:0; bottom:0; background:rgba(255,255,255,0.3); border-radius:12px;"></div>
            <div style="position:relative; z-index:2;">
              <div class="exercise-icon"></div>
              <h4>IQ Magazine</h4>
              <p>Brain & intelligence articles</p>
            </div>
          </div>
        </div>
      </div>
      
      <div class="iq-store">
        <h3>ğŸ›’ IQ Store</h3>
        <p>Premium brain training tools and resources</p>
        
        <div class="store-grid">
          <div class="exercise-card" onclick="openStore()" style="background-image:url('images/store.png'); background-size:contain; background-position:center; position:relative;">
            <div style="position:absolute; top:0; left:0; right:0; bottom:0; background:rgba(255,255,255,0.3); border-radius:12px;"></div>
            <div style="position:relative; z-index:2;">
              <div class="exercise-icon"></div>
              <h4>IQ Store</h4>
              <p>Premium products & courses</p>
            </div>
          </div>
        </div>
      </div>
      

    </div>
    <div id="quiz-screen" style="display: none;">
      <div class="progress-container">
        <div class="progress-bar">
          <div class="progress-fill" id="progress-fill"></div>
        </div>
        <div class="progress-text">
          <button id="fullscreen-btn" class="fullscreen-btn" title="Toggle Fullscreen">â›¶</button>
          <span id="current-question">1</span> / <span id="total-questions">10</span>
          <span class="timer-display">
            â±ï¸ <span id="timer">60</span>s
          </span>
        </div>
      </div>
      <div class="question">
        <div id="loading-spinner" class="spinner" style="display: none;">
          <div class="spinner-ring"></div>
          <p>Loading question...</p>
        </div>
        <div id="error-message" class="error-msg" style="display: none;">
          <div class="error-icon">âš ï¸</div>
          <p>Failed to load question. Please try again.</p>
          <button id="retry-btn" class="retry-button">Retry</button>
        </div>
        <img id="question-image" src="" alt="Question" />
      </div>
      <div class="options" id="options"></div>
      <div class="navigation-buttons">
        <button id="prev-btn" class="nav-btn">â† Previous</button>
        <button id="next-btn" class="nav-btn">Next â†’</button>
      </div>
    </div>
    <div id="result-screen" style="display: none;">
      <h2 id="result-text"></h2>
      <div class="social-share">
        <h3>Share Your Result:</h3>
        <div class="share-buttons">
          <button id="share-facebook" class="share-btn facebook">ğŸ“˜ Facebook</button>
          <button id="share-twitter" class="share-btn twitter">ğŸ¦ Twitter/X</button>
          <button id="share-snapchat" class="share-btn snapchat">ğŸ‘» Snapchat</button>
          <button id="share-whatsapp" class="share-btn whatsapp">ğŸ’¬ WhatsApp</button>
          <button id="share-viber" class="share-btn viber">ğŸŸ£ Viber</button>
          <button id="copy-link" class="share-btn copy-link">ğŸ”— Copy Link</button>
        </div>
      </div>
      <button id="restart-btn">Try Again</button>
      <button id="leaderboard-btn" style="margin-left:10px;">Leaderboard</button>
      <div id="save-score-modal" style="display:none; margin-top:32px; background:rgba(255,255,255,0.3); border-radius:12px; box-shadow:0 2px 8px #0002; padding:24px; max-width:340px; margin-left:auto; margin-right:auto;">
        <h3>Save my IQ score</h3>
        <form id="save-score-form">
          <input type="text" id="modal-name" name="modal-name" placeholder="Name" required style="width:100%;margin-bottom:10px;">
          <input type="number" id="modal-iq" name="modal-iq" placeholder="IQ Score" required style="width:100%;margin-bottom:10px;">
          <select id="modal-country" name="modal-country" required style="width:100%;margin-bottom:10px;"></select>
          <button type="submit" id="save-score-btn" style="width:100%;background:#007bff;color:#fff;border:none;padding:10px 0;border-radius:8px;font-weight:bold;">Save</button>
        </form>
      </div>
      
      <!-- Fullscreen overlay -->
      <div id="fullscreen-overlay" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.9); z-index:9999; cursor:pointer;" onclick="closeFullscreenImage()">
        <div style="position:absolute; top:20px; right:30px; color:white; font-size:40px; cursor:pointer; z-index:10000;" onclick="closeFullscreenImage()">&times;</div>
        <img id="fullscreen-image" src="images/iq-scale.png" alt="IQ Scale" style="position:absolute; top:50%; left:50%; transform:translate(-50%, -50%); max-width:90%; max-height:90%; object-fit:contain;">
      </div>
      </div>
      
      <!-- Memory Game Screen -->
      <div id="memory-game-screen" style="display: none;">
        <div class="game-header">
          <button id="back-to-menu" class="back-btn">â† Back</button>

          <h2>ğŸ§  Memory Training</h2>
          <div class="game-stats">
            <span>Level: <span id="game-level">1</span></span>
            <span>Score: <span id="game-score">0</span></span>
          </div>
        </div>
        
        <div class="game-info">
          <p id="game-instruction">Watch the sequence, then repeat it!</p>
        </div>
        
        <div class="memory-grid">
          <div class="memory-btn" data-color="0"></div>
          <div class="memory-btn" data-color="1"></div>
          <div class="memory-btn" data-color="2"></div>
          <div class="memory-btn" data-color="3"></div>
        </div>
        
        <div class="game-controls">
          <button id="start-memory-game" class="game-control-btn">Start Game</button>
          <button id="restart-memory-game" class="game-control-btn" style="display:none;">Try Again</button>
        </div>
      </div>
      
      <!-- Logic Game Screen -->
      <div id="logic-game-screen" style="display: none;">
        <div class="game-header">
          <button id="back-to-menu-logic" class="back-btn">â† Back</button>
          <h2>ğŸ”¢ Logic Puzzles</h2>
          <div class="game-stats">
            <span>Level: <span id="logic-level">1</span></span>
            <span>Score: <span id="logic-score">0</span></span>
          </div>
        </div>
        
        <div class="game-info">
          <p id="logic-instruction">Find the missing number in the sequence!</p>
        </div>
        
        <div style="text-align:center; margin:30px 0;">
          <div id="sequence-display" style="font-size:32px; font-weight:bold; color:#333; margin-bottom:20px;"></div>
          <div>
            <input type="number" id="logic-answer" placeholder="?" style="font-size:24px; text-align:center; width:80px; padding:10px; border:2px solid #ffd700; border-radius:8px; margin-right:10px;">
            <button id="submit-logic" class="game-control-btn">Submit</button>
          </div>
        </div>
        
        <div class="game-controls">
          <button id="start-logic-game" class="game-control-btn">Start Game</button>
          <button id="restart-logic-game" class="game-control-btn" style="display:none;">Try Again</button>
        </div>
      </div>
      
      <!-- Reaction Time Game Screen -->
      <div id="reaction-game-screen" style="display: none;">
        <div class="game-header">
          <button id="back-to-menu-reaction" class="back-btn">â† Back</button>
          <h2>ğŸ¯ Reaction Time</h2>
          <div class="game-stats">
            <span>Best: <span id="reaction-best">-</span>ms</span>
            <span>Average: <span id="reaction-avg">-</span>ms</span>
          </div>
        </div>
        
        <div class="game-info">
          <p id="reaction-instruction">Click when the screen turns green!</p>
        </div>
        
        <div style="text-align:center; margin:30px 0;">
          <div id="reaction-area" style="width:400px; height:300px; margin:0 auto; border:3px solid #ffd700; border-radius:15px; background:#f0f0f0; display:flex; align-items:center; justify-content:center; font-size:24px; cursor:pointer; transition:background 0.1s;">
            Click to start!
          </div>
          <div id="reaction-result" style="font-size:32px; font-weight:bold; margin-top:20px; color:#333;"></div>
        </div>
        
        <div class="game-controls">
          <button id="start-reaction-game" class="game-control-btn">Start Test</button>
          <button id="restart-reaction-game" class="game-control-btn" style="display:none;">Try Again</button>
        </div>
      </div>
      
      <!-- Pattern Game Screen -->
      <div id="pattern-game-screen" style="display: none;">
        <div class="game-header">
          <button id="back-to-menu-pattern" class="back-btn">â† Back</button>
          <h2>ğŸ”„ Rotation Patterns</h2>
          <div class="game-stats">
            <span>Level: <span id="pattern-level">1</span></span>
            <span>Score: <span id="pattern-score">0</span></span>
          </div>
        </div>
        
        <div class="game-info">
          <p id="pattern-instruction">Which shape comes next in the rotation?</p>
        </div>
        
        <div style="text-align:center; margin:30px 0;">
          <div id="pattern-sequence" style="display:flex; justify-content:center; gap:20px; margin-bottom:30px;">
            <div class="pattern-item">ğŸ”º</div>
            <div class="pattern-item">ğŸ”»</div>
            <div class="pattern-item">ğŸ”¼</div>
            <div class="pattern-item">?</div>
          </div>
          
          <div id="pattern-options" style="display:flex; justify-content:center; gap:15px;">
            <div class="pattern-option" onclick="checkPatternAnswer(0)">ğŸ”½</div>
            <div class="pattern-option" onclick="checkPatternAnswer(1)">ğŸ”º</div>
            <div class="pattern-option" onclick="checkPatternAnswer(2)">ğŸ”»</div>
          </div>
        </div>
        
        <div class="game-controls">
          <button id="start-pattern-game" class="game-control-btn">Start Game</button>
          <button id="restart-pattern-game" class="game-control-btn" style="display:none;">Try Again</button>
        </div>
      </div>
      
      <!-- Number Merge Game Screen -->
      <div id="numbers-game-screen" style="display: none;">
        <div class="game-header">
          <button id="back-to-menu-numbers" class="back-btn">â† Back</button>
          <h2>ğŸ”¢ Number Merge</h2>
          <div class="game-stats">
            <span>Score: <span id="numbers-score">0</span></span>
            <span>Best: <span id="numbers-best">0</span></span>
          </div>
        </div>
        
        <div class="game-info">
          <p id="numbers-instruction">Swipe to merge numbers and reach 2048!</p>
        </div>
        
        <div id="numbers-grid" style="width:320px; height:320px; margin:20px auto; background:#bbada0; border-radius:10px; position:relative; display:grid; grid-template-columns:repeat(4,1fr); grid-template-rows:repeat(4,1fr); gap:10px; padding:10px;">
          <!-- Grid cells will be generated by JavaScript -->
        </div>
        
        <div class="game-controls" style="position:relative;">
          <button id="start-numbers-game" class="game-control-btn">New Game</button>
          <button id="restart-numbers-game" class="game-control-btn" style="display:none;">Try Again</button>
        </div>
        
        <!-- Mobile Controls for 2048 -->
        <div id="numbers-mobile-controls" style="display:block !important; position:fixed; z-index:99999;">
          <div style="position:fixed; top:20px; left:10px; width:50px; height:50px; background:rgba(255,215,0,0.9); border:2px solid #ffd700; border-radius:10px; display:flex; align-items:center; justify-content:center; font-weight:bold; color:#1a1a2e; z-index:99999; touch-action:manipulation; font-size:18px;" ontouchstart="simulateNumbersKey('ArrowLeft')" ontouchend="releaseNumbersKey('ArrowLeft')">â†</div>
          <div style="position:fixed; top:20px; left:70px; width:50px; height:50px; background:rgba(255,215,0,0.9); border:2px solid #ffd700; border-radius:10px; display:flex; align-items:center; justify-content:center; font-weight:bold; color:#1a1a2e; z-index:99999; touch-action:manipulation; font-size:18px;" ontouchstart="simulateNumbersKey('ArrowRight')" ontouchend="releaseNumbersKey('ArrowRight')">â†’</div>
          <div style="position:fixed; top:20px; right:70px; width:50px; height:50px; background:rgba(255,215,0,0.9); border:2px solid #ffd700; border-radius:10px; display:flex; align-items:center; justify-content:center; font-weight:bold; color:#1a1a2e; z-index:99999; touch-action:manipulation; font-size:18px;" ontouchstart="simulateNumbersKey('ArrowUp')" ontouchend="releaseNumbersKey('ArrowUp')">â†‘</div>
          <div style="position:fixed; top:20px; right:10px; width:50px; height:50px; background:rgba(255,215,0,0.9); border:2px solid #ffd700; border-radius:10px; display:flex; align-items:center; justify-content:center; font-weight:bold; color:#1a1a2e; z-index:99999; touch-action:manipulation; font-size:18px;" ontouchstart="simulateNumbersKey('ArrowDown')" ontouchend="releaseNumbersKey('ArrowDown')">â†“</div>
        </div>
        
        <div style="text-align:center; margin-top:20px; color:#776e65;">
          <p><strong>HOW TO PLAY:</strong> Use arrow keys or swipe to move tiles. When two tiles with the same number touch, they merge into one!</p>
        </div>
      </div>
      
      <!-- Tetris Game Screen -->
      <div id="tetris-game-screen" style="display: none;">
        <div class="game-header">
          <button id="back-to-menu-tetris" class="back-btn">â† Back</button>
          <button id="controls-btn-tetris" class="back-btn">ğŸ® Controls</button>
          <h2>ğŸ§± Tetris</h2>
          <div class="game-stats" style="display:flex !important; flex-direction:row !important; gap:20px !important; justify-content:center !important;">
            <span>Score: <span id="tetris-score">0</span></span>
            <span>Lines: <span id="tetris-lines">0</span></span>
            <span>Level: <span id="tetris-level">1</span></span>
          </div>
        </div>
        
        <div class="game-info">
          <p id="tetris-instruction">Use arrow keys to move and rotate blocks</p>
        </div>
        
        <div style="display:flex; justify-content:center; gap:20px; margin:20px 0;">
          <div id="tetris-board" style="width:300px; height:600px; background:#000; border:3px solid #ffd700; position:relative; overflow:hidden;">
            <!-- Game board -->
          </div>
          
          <div style="width:120px;">
            <div style="background:rgba(255,255,255,0.1); padding:15px; border-radius:8px; margin-bottom:15px;">
              <h4 style="color:#ffd700; margin:0 0 10px;">Next:</h4>
              <div id="next-piece" style="width:80px; height:80px; background:#333; border:1px solid #666;"></div>
            </div>
            
            <div style="background:rgba(255,255,255,0.1); padding:15px; border-radius:8px;">
              <h4 style="color:#ffd700; margin:0 0 10px;">Controls:</h4>
              <div style="font-size:12px; color:#fff; line-height:1.4;">
                <div>â†â†’ Move</div>
                <div>â†“ Drop</div>
                <div>â†‘ Rotate</div>
                <div>Space: Pause</div>
              </div>
            </div>
          </div>
        </div>
        
        <div class="game-controls">
          <button id="start-tetris" class="game-control-btn">Start Game</button>
          <button id="pause-tetris" class="game-control-btn">Pause</button>
          <button id="restart-tetris" class="game-control-btn">Restart</button>
        </div>
        
        <!-- Mobile Controls for Tetris -->
        <div id="tetris-mobile-controls" style="display:block !important; position:fixed; z-index:99999;">
          <div style="position:fixed; top:60%; right:80px; width:50px; height:50px; background:rgba(255,215,0,0.9); border:2px solid #ffd700; border-radius:10px; display:flex; align-items:center; justify-content:center; font-weight:bold; color:#1a1a2e; z-index:99999; touch-action:manipulation;" ontouchstart="simulateTetrisKey('ArrowUp')" ontouchend="releaseTetrisKey('ArrowUp')">â†‘</div>
          <div style="position:fixed; top:75%; right:80px; width:50px; height:50px; background:rgba(255,215,0,0.9); border:2px solid #ffd700; border-radius:10px; display:flex; align-items:center; justify-content:center; font-weight:bold; color:#1a1a2e; z-index:99999; touch-action:manipulation;" ontouchstart="simulateTetrisKey('ArrowDown')" ontouchend="releaseTetrisKey('ArrowDown')">â†“</div>
          <div style="position:fixed; top:67.5%; right:120px; width:50px; height:50px; background:rgba(255,215,0,0.9); border:2px solid #ffd700; border-radius:10px; display:flex; align-items:center; justify-content:center; font-weight:bold; color:#1a1a2e; z-index:99999; touch-action:manipulation;" ontouchstart="simulateTetrisKey('ArrowLeft')" ontouchend="releaseTetrisKey('ArrowLeft')">â†</div>
          <div style="position:fixed; top:67.5%; right:40px; width:50px; height:50px; background:rgba(255,215,0,0.9); border:2px solid #ffd700; border-radius:10px; display:flex; align-items:center; justify-content:center; font-weight:bold; color:#1a1a2e; z-index:99999; touch-action:manipulation;" ontouchstart="simulateTetrisKey('ArrowRight')" ontouchend="releaseTetrisKey('ArrowRight')">â†’</div>
          <div style="position:fixed; bottom:20px; left:50%; transform:translateX(-50%); width:80px; height:50px; background:rgba(255,215,0,0.9); border:2px solid #ffd700; border-radius:10px; display:flex; align-items:center; justify-content:center; font-weight:bold; color:#1a1a2e; z-index:99999; touch-action:manipulation;" ontouchstart="simulateTetrisKey(' ')" ontouchend="releaseTetrisKey(' ')">PAUSE</div>
        </div>
      </div>
      
      <!-- Sudoku Game Screen -->
      <div id="sudoku-game-screen" style="display: none;">
        <div class="game-header">
          <button id="back-to-menu-sudoku" class="back-btn">â† Back</button>
          <h2>ğŸ”¢ Sudoku</h2>
          <div class="game-stats">
            <span>Time: <span id="sudoku-time">00:00</span></span>
            <span>Difficulty: <span id="sudoku-difficulty">Easy</span></span>
          </div>
        </div>
        
        <div class="game-info">
          <p id="sudoku-instruction">Fill the grid so each row, column and 3x3 box contains digits 1-9</p>
        </div>
        
        <div id="sudoku-grid" style="width:360px; height:360px; margin:20px auto; display:grid; grid-template-columns:repeat(9,1fr); grid-template-rows:repeat(9,1fr); gap:1px; background:#333; border:3px solid #ffd700; border-radius:8px;">
          <!-- Grid cells will be generated by JavaScript -->
        </div>
        
        <div class="sudoku-controls" style="text-align:center; margin:20px 0;">
          <div id="number-pad" style="display:grid; grid-template-columns:repeat(5,1fr); gap:10px; max-width:300px; margin:0 auto 20px;">
            <button class="number-btn" onclick="selectNumber(1)">1</button>
            <button class="number-btn" onclick="selectNumber(2)">2</button>
            <button class="number-btn" onclick="selectNumber(3)">3</button>
            <button class="number-btn" onclick="selectNumber(4)">4</button>
            <button class="number-btn" onclick="selectNumber(5)">5</button>
            <button class="number-btn" onclick="selectNumber(6)">6</button>
            <button class="number-btn" onclick="selectNumber(7)">7</button>
            <button class="number-btn" onclick="selectNumber(8)">8</button>
            <button class="number-btn" onclick="selectNumber(9)">9</button>
            <button class="number-btn" onclick="selectNumber(0)">Clear</button>
          </div>
        </div>
        
        <div class="game-controls">
          <button id="new-sudoku-game" class="game-control-btn">New Game</button>
          <button id="hint-sudoku" class="game-control-btn">Hint</button>
          <button id="solve-sudoku" class="game-control-btn">Solve</button>
        </div>
      </div>
      
      <!-- Formula Racing Game Screen -->
      <div id="racing-game-screen" style="display: none;">
        <div style="position:absolute; top:10px; left:10px; z-index:10; background:rgba(0,0,0,0.7); padding:10px; border-radius:8px;">
          <button id="back-to-menu-racing" class="back-btn">â† Back</button>
          <button id="controls-btn-racing" class="back-btn">ğŸ® Controls</button>
          <button id="leaderboard-btn-racing" class="back-btn">ğŸ† Leaderboard</button>
        </div>
        
        <div style="position:absolute; top:10px; right:10px; z-index:10; background:rgba(0,0,0,0.7); padding:10px; border-radius:8px; color:#fff;">
          <div>Lives: <span id="racing-lives">3</span></div>
          <div>Score: <span id="racing-score">0</span></div>
        </div>
        
        <!-- Futuristic Speedometer -->
        <div style="position:absolute; top:80px; right:10px; z-index:10; width:120px; height:120px;">
          <svg width="120" height="120" style="transform:rotate(-90deg);">
            <!-- Background circle -->
            <circle cx="60" cy="60" r="50" fill="none" stroke="rgba(0,255,255,0.2)" stroke-width="8"/>
            <!-- Speed arc -->
            <circle id="speed-arc" cx="60" cy="60" r="50" fill="none" stroke="#00ffff" stroke-width="8" stroke-dasharray="314" stroke-dashoffset="314" style="transition:stroke-dashoffset 0.3s; filter:drop-shadow(0 0 10px #00ffff);"/>
          </svg>
          <div style="position:absolute; top:50%; left:50%; transform:translate(-50%,-50%); text-align:center; color:#00ffff; font-weight:bold; text-shadow:0 0 10px #00ffff;">
            <div id="speed-display" style="font-size:18px;">0</div>
            <div style="font-size:10px;">km/h</div>
          </div>
        </div>
        
        <div id="racing-track" style="width:622px; height:792px; margin:10px auto; background:linear-gradient(180deg, #000428 0%, #004e92 100%); border:3px solid #00ffff; border-radius:10px; position:relative; overflow:hidden; box-shadow:0 0 20px #00ffff, inset 0 0 20px rgba(0,255,255,0.2);">
          <!-- Dashed center lines -->
          <div id="lane-line-1" style="position:absolute; left:calc(16.5% - 2px); top:0; bottom:0; width:4px; background:repeating-linear-gradient(to bottom, #00ffff 0px, #00ffff 30px, transparent 30px, transparent 60px); box-shadow:0 0 10px #00ffff; z-index:1; transform:translateY(0px);"></div>
          <div id="lane-line-2" style="position:absolute; left:calc(50% - 2px); top:0; bottom:0; width:4px; background:repeating-linear-gradient(to bottom, #ffff00 0px, #ffff00 30px, transparent 30px, transparent 60px); box-shadow:0 0 10px #ffff00; z-index:1; transform:translateY(0px);"></div>
          <div id="lane-line-3" style="position:absolute; left:calc(83.5% - 2px); top:0; bottom:0; width:4px; background:repeating-linear-gradient(to bottom, #00ffff 0px, #00ffff 30px, transparent 30px, transparent 60px); box-shadow:0 0 10px #00ffff; z-index:1; transform:translateY(0px);"></div>
          
          <!-- Track lanes -->
          <div style="position:absolute; left:33%; top:0; bottom:0; width:2px; background:#00ffff; box-shadow:0 0 10px #00ffff; z-index:2;"></div>
          <div style="position:absolute; left:66%; top:0; bottom:0; width:2px; background:#00ffff; box-shadow:0 0 10px #00ffff; z-index:2;"></div>
          

          
          <!-- Side barriers -->
          <div style="position:absolute; left:0; top:0; bottom:0; width:3px; background:#ff0080; box-shadow:0 0 15px #ff0080; z-index:2;"></div>
          <div style="position:absolute; right:0; top:0; bottom:0; width:3px; background:#ff0080; box-shadow:0 0 15px #ff0080; z-index:2;"></div>
          
          <!-- Player car -->
          <div id="player-car" style="position:absolute; bottom:20px; left:50%; transform:translateX(-50%); width:120px; height:180px; transition:left 0.1s; z-index:3; display:flex; align-items:center; justify-content:center;">
            <img src="images/formula.png" alt="Formula Car" style="width:100%; height:100%; object-fit:contain;">
          </div>
        </div>
        
        <div class="game-controls">
          <button id="start-racing-game" class="game-control-btn">Start Race</button>
          <button id="restart-racing-game" class="game-control-btn" style="display:none;">Try Again</button>
          <button id="fullscreen-racing-btn" class="game-control-btn">â›¶ Fullscreen</button>
        </div>
        
        <!-- Controls Modal -->
        <div id="controls-modal-racing" style="display:none; position:fixed; top:50%; left:50%; transform:translate(-50%,-50%); background:rgba(0,0,0,0.9); color:#fff; padding:30px; border-radius:15px; border:2px solid #00ffff; box-shadow:0 0 20px #00ffff; z-index:1000; max-width:400px;">
          <h3 style="color:#00ffff; margin-bottom:20px;">ğŸ® Racing Controls</h3>
          <div style="text-align:left; line-height:1.8;">
            <p><strong>â† â†’ or A/D:</strong> Move left/right</p>
            <p><strong>â†‘ or W:</strong> Boost (hold for speed)</p>
            <p><strong>â†“ or S:</strong> Brake/Slow down</p>
            <p><strong>SPACE:</strong> Pause/Resume game</p>
          </div>
          <button onclick="document.getElementById('controls-modal-racing').style.display='none'" style="margin-top:20px; background:#00ffff; color:#000; border:none; padding:10px 20px; border-radius:8px; cursor:pointer;">Close</button>
        </div>
        
        <!-- Leaderboard Modal -->
        <div id="leaderboard-modal-racing" style="display:none; position:fixed; top:50%; left:50%; transform:translate(-50%,-50%); background:rgba(0,0,0,0.9); color:#fff; padding:30px; border-radius:15px; border:2px solid #ffd700; box-shadow:0 0 20px #ffd700; z-index:1000; max-width:600px; max-height:80vh; overflow-y:auto;">
          <h3 style="color:#ffd700; margin-bottom:20px;">ğŸ† Racing Leaderboard</h3>
          <div id="racing-leaderboard-content" style="margin-bottom:20px;">
            <!-- Leaderboard content -->
          </div>
          <button onclick="document.getElementById('leaderboard-modal-racing').style.display='none'" style="margin-top:20px; background:#ffd700; color:#000; border:none; padding:10px 20px; border-radius:8px; cursor:pointer;">Close</button>
        </div>
      </div>
    </div>
    
    <div class="right-banner"></div>
  </div>
  <div class="footer-banner"></div>
  

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <script src="sounds.js"></script>
  <script src="game-music.js"></script>
  <script src="auto-meta.js"></script>
  <script>
    // Check for IQ parameter and update meta tag
    const urlParams = new URLSearchParams(window.location.search);
    const iqScore = urlParams.get('iq');
    if (iqScore) {
      const ogImage = document.getElementById('og-image');
      ogImage.content = `images/iq-score-${iqScore}.png`;
    }
  </script>


  <script>
    // Mobile controls functions for Tetris
    function simulateTetrisKey(key) {
      const event = new KeyboardEvent('keydown', { key: key, bubbles: true });
      document.dispatchEvent(event);
    }
    
    function releaseTetrisKey(key) {
      const event = new KeyboardEvent('keyup', { key: key, bubbles: true });
      document.dispatchEvent(event);
    }
    
    // Mobile controls functions for 2048
    function simulateNumbersKey(key) {
      const event = new KeyboardEvent('keydown', { key: key, bubbles: true });
      document.dispatchEvent(event);
    }
    
    function releaseNumbersKey(key) {
      const event = new KeyboardEvent('keyup', { key: key, bubbles: true });
      document.dispatchEvent(event);
    }
    
    // Show mobile controls on mobile devices
    if (window.innerWidth <= 768) {
      const numbersControls = document.getElementById('numbers-mobile-controls');
      if (numbersControls) numbersControls.style.display = 'block';
    }
  </script>
  <script src="mobile-controls.js"></script>
  <script>
    const pages = [
      {name: 'IQ Test', url: 'index.html', keywords: ['iq', 'test', 'intelligence', 'brain']},
      {name: 'Memory Training', url: 'memory-training.html', keywords: ['memory', 'training', 'brain', 'exercise']},
      {name: 'Logic Puzzles', url: 'logic-puzzles.html', keywords: ['logic', 'puzzle', 'reasoning', 'math']},
      {name: 'Pattern Recognition', url: 'pattern-recognition.html', keywords: ['pattern', 'recognition', 'visual', 'shapes']},
      {name: 'Reaction Time', url: 'reaction-time.html', keywords: ['reaction', 'time', 'speed', 'reflex']},
      {name: 'Formula Racing', url: 'formula-racing.html', keywords: ['racing', 'formula', 'car', 'speed', 'game']},
      {name: 'Number Merge', url: 'number-merge.html', keywords: ['number', 'merge', '2048', 'puzzle']},
      {name: 'Sudoku', url: 'sudoku-puzzle.html', keywords: ['sudoku', 'puzzle', 'numbers', 'grid']},
      {name: 'Tetris', url: 'tetris-blocks.html', keywords: ['tetris', 'blocks', 'puzzle', 'game']},
      {name: 'Age of Mythology', url: 'age-of-mythology-ultimate.html', keywords: ['mythology', 'strategy', 'rts', 'game']},
      {name: 'IQ Magazine', url: 'iq-magazine.html', keywords: ['magazine', 'articles', 'intelligence', 'brain']},
      {name: 'IQ Store', url: 'iq-store.html', keywords: ['store', 'products', 'premium', 'brain']},
      {name: 'Leaderboard', url: 'leaderboard.html', keywords: ['leaderboard', 'scores', 'ranking', 'top']},
      {name: 'Register', url: 'register.html', keywords: ['register', 'signup', 'account', 'join']},
      {name: 'Login', url: 'login.html', keywords: ['login', 'signin', 'account', 'enter']}
    ];
    
    function showSearchSuggestions(query) {
      const dropdown = document.getElementById('searchDropdown');
      if (!query.trim()) {
        dropdown.style.display = 'none';
        return;
      }
      
      const matches = pages.filter(page => 
        page.name.toLowerCase().includes(query.toLowerCase()) ||
        page.keywords.some(keyword => keyword.toLowerCase().includes(query.toLowerCase()))
      ).slice(0, 5);
      
      if (matches.length === 0) {
        dropdown.style.display = 'none';
        return;
      }
      
      dropdown.innerHTML = matches.map(page => 
        `<div class="search-item" onclick="window.location.href='${page.url}'">${page.name}</div>`
      ).join('');
      
      dropdown.style.display = 'block';
    }
    
    document.addEventListener('click', function(e) {
      if (!e.target.closest('.search-container')) {
        document.getElementById('searchDropdown').style.display = 'none';
      }
    });
  </script>
  <!-- Login Modal -->
  <div id="login-modal" style="position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.8); display:none; justify-content:center; align-items:center; z-index:2000;">
    <div style="background:#333; padding:40px; border-radius:15px; width:400px; text-align:center; border:2px solid #ffd700;">
      <h2 style="color:#ffd700; margin-bottom:30px;">ğŸ” Login</h2>
      <input type="email" id="login-email" placeholder="Email" style="width:100%; padding:12px; margin-bottom:15px; border:none; border-radius:8px; background:#555; color:white; font-size:16px;">
      <input type="password" id="login-password" placeholder="Password" style="width:100%; padding:12px; margin-bottom:15px; border:none; border-radius:8px; background:#555; color:white; font-size:16px;">
      <button onclick="login()" style="width:100%; padding:12px; border:none; border-radius:8px; font-size:16px; font-weight:bold; cursor:pointer; margin-bottom:10px; background:#007bff; color:white;">Login</button>
      <button onclick="closeModal()" style="width:100%; padding:12px; border:none; border-radius:8px; font-size:16px; font-weight:bold; cursor:pointer; background:#666; color:white;">Cancel</button>
    </div>
  </div>
  
  <!-- Register Modal -->
  <div id="register-modal" style="position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.8); display:none; justify-content:center; align-items:center; z-index:2000;">
    <div style="background:#333; padding:40px; border-radius:15px; width:400px; text-align:center; border:2px solid #ffd700;">
      <h2 style="color:#ffd700; margin-bottom:30px;">ğŸ“ Register</h2>
      <input type="email" id="register-email" placeholder="Email" style="width:100%; padding:12px; margin-bottom:15px; border:none; border-radius:8px; background:#555; color:white; font-size:16px;">
      <input type="password" id="register-password" placeholder="Password (min 8 chars)" style="width:100%; padding:12px; margin-bottom:15px; border:none; border-radius:8px; background:#555; color:white; font-size:16px;">
      <button onclick="register()" style="width:100%; padding:12px; border:none; border-radius:8px; font-size:16px; font-weight:bold; cursor:pointer; margin-bottom:10px; background:#28a745; color:white;">Register</button>
      <button onclick="closeModal()" style="width:100%; padding:12px; border:none; border-radius:8px; font-size:16px; font-weight:bold; cursor:pointer; background:#666; color:white;">Cancel</button>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script src="auto-footer-generator.js"></script>
  <script src="global-auth.js"></script>
  <script type="module" src="shared-auth.js"></script>
  <script type="module">
    import { auth } from './shared-auth.js';
    import { createUserWithEmailAndPassword, signInWithEmailAndPassword, signOut, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-auth.js";
    
    window.showLogin = () => document.getElementById('login-modal').style.display = 'flex';
    window.showRegister = () => document.getElementById('register-modal').style.display = 'flex';
    window.closeModal = () => {
      document.getElementById('login-modal').style.display = 'none';
      document.getElementById('register-modal').style.display = 'none';
    }
    
    window.register = function() {
      const email = document.getElementById('register-email').value;
      const password = document.getElementById('register-password').value;
      
      if (!email || !password) return alert('Email and password required!');
      if (password.length < 8) return alert('Password must be 8+ characters!');
      
      createUserWithEmailAndPassword(auth, email, password)
        .then(() => closeModal())
        .catch(error => alert(error.message));
    }
    
    window.login = function() {
      const email = document.getElementById('login-email').value;
      const password = document.getElementById('login-password').value;
      
      if (!email || !password) return alert('Email and password required!');
      
      // Save to global localStorage immediately
      const username = email.split('@')[0];
      const isAdmin = email === 'davidandelkov@gmail.com';
      
      localStorage.setItem('globalUserLogin', JSON.stringify({
        email: email,
        username: username,
        isAdmin: isAdmin,
        timestamp: Date.now()
      }));
      
      signInWithEmailAndPassword(auth, email, password)
        .then(() => closeModal())
        .catch(error => alert(error.message));
    }
    
    window.logout = () => {
      localStorage.removeItem('globalUserLogin');
      signOut(auth);
      document.getElementById('account-menu').style.display = 'none';
    }
    
    window.toggleAccountMenu = () => {
      const menu = document.getElementById('account-menu');
      menu.style.display = menu.style.display === 'none' ? 'block' : 'none';
    }
    
    window.toggleMobileMenu = () => {
      const menu = document.getElementById('mobile-menu');
      menu.classList.toggle('active');
    }
    
    function showMobileSearchSuggestions(query) {
      const dropdown = document.getElementById('mobile-search-dropdown');
      if (!query.trim()) {
        dropdown.style.display = 'none';
        return;
      }
      
      const matches = pages.filter(page => 
        page.name.toLowerCase().includes(query.toLowerCase()) ||
        page.keywords.some(keyword => keyword.toLowerCase().includes(query.toLowerCase()))
      ).slice(0, 5);
      
      if (matches.length === 0) {
        dropdown.style.display = 'none';
        return;
      }
      
      dropdown.innerHTML = matches.map(page => 
        `<div onclick="window.location.href='${page.url}'; toggleMobileMenu();" style="padding:10px; color:#ffd700; cursor:pointer; border-bottom:1px solid #555;" onmouseover="this.style.background='#555'" onmouseout="this.style.background='transparent'">${page.name}</div>`
      ).join('');
      
      dropdown.style.display = 'block';
    }
    
    // Close menu when clicking outside
    document.addEventListener('click', (e) => {
      if (!e.target.closest('#user-panel')) {
        const menu = document.getElementById('account-menu');
        if (menu) menu.style.display = 'none';
      }
    });
    
    // Global login system
    function checkLoginStatus() {
      const loginData = localStorage.getItem('globalUserLogin');
      const authButtonsDiv = document.getElementById('auth-buttons');
      const userPanel = document.getElementById('user-panel');
      const userEmail = document.getElementById('user-email');
      
      if (loginData) {
        const user = JSON.parse(loginData);
        authButtonsDiv.style.display = 'none';
        userPanel.style.display = 'block';
        
        userEmail.innerHTML = user.isAdmin ? 
          `${user.username} <span style="background:#dc3545; color:white; padding:2px 6px; border-radius:10px; font-size:10px; margin-left:5px;">ADMIN</span>` : 
          user.username;
        
        const adminPanelOption = document.getElementById('admin-panel-option');
        if (adminPanelOption) {
          adminPanelOption.style.display = user.isAdmin ? 'block' : 'none';
        }
      } else {
        authButtonsDiv.style.display = 'flex';
        userPanel.style.display = 'none';
      }
    }
    
    // Supabase configuration
    const supabase = window.supabase.createClient('https://rvfyefrfhzcyadnavcxv.supabase.co', 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InJ2ZnllZnJmaHpjeWFkbmF2Y3h2Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTg2MTk1ODUsImV4cCI6MjA3NDE5NTU4NX0.QDEnNGGjRX55JuRaWl74V1y_GctN3HEYUFAUfvQG2zA');
    
    // Load articles from Supabase and display on home page
    async function loadSupabaseArticlesOnHomePage() {
      try {
        const { data, error } = await supabase
          .from('articles')
          .select('*')
          .eq('visible', true)
          .order('id', { ascending: false })
          .limit(6);
        
        if (error) {
          console.error('Supabase error:', error);
          return;
        }
        
        // Find magazine section and add articles
        const magazineGrid = document.querySelector('.iq-magazine .magazine-grid');
        if (magazineGrid && data && data.length > 0) {
          data.forEach(article => {
            // Sync to localStorage categories
            if (article.category) {
              const categoryKey = `${article.category}Articles`;
              const categoryArticles = JSON.parse(localStorage.getItem(categoryKey) || '[]');
              const exists = categoryArticles.some(a => a.title === article.title);
              if (!exists) {
                categoryArticles.unshift(article);
                localStorage.setItem(categoryKey, JSON.stringify(categoryArticles));
              }
            }
            
            const articleCard = document.createElement('div');
            articleCard.className = 'exercise-card';
            articleCard.style.cssText = 'background:white; padding:20px; border-radius:12px; border:2px solid #ffd700; text-align:center; cursor:pointer; position:relative;';
            
            const categoryIcons = {
              'increase-iq': 'ğŸ’¡',
              'improve-brain': 'âš¡', 
              'modern-psychology': 'ğŸ”¬',
              'traditional-psychology': 'ğŸ“œ'
            };
            
            const tempDiv = document.createElement('div');
            tempDiv.innerHTML = article.content;
            const textContent = tempDiv.textContent || tempDiv.innerText || '';
            
            articleCard.innerHTML = `
              <div style="position:relative; z-index:2;">
                <div class="exercise-icon" style="font-size:48px; margin-bottom:15px;">${categoryIcons[article.category] || 'ğŸ“„'}</div>
                <h4 style="color:#333; margin-bottom:10px;">${article.title}</h4>
                <p style="color:#666; margin-bottom:15px; font-size:14px;">${textContent.substring(0, 80)}...</p>
                <div style="color:#ffd700; font-weight:bold; font-size:12px;">ğŸ“… ${article.date}</div>
              </div>
            `;
            
            articleCard.onclick = () => {
              localStorage.setItem('currentArticle', JSON.stringify(article));
              window.open('article-view.html', '_blank');
            };
            
            magazineGrid.appendChild(articleCard);
          });
        }
      } catch (error) {
        console.error('Error loading Supabase articles:', error);
      }
    }
    
    // Listen for articles updates
    window.addEventListener('storage', (e) => {
      if (e.key === 'articlesUpdated') {
        // Refresh articles when they are updated globally
        setTimeout(() => {
          loadSupabaseArticlesOnHomePage();
        }, 1000);
      }
    });
    
    // Check on page load
    window.addEventListener('load', () => {
      checkLoginStatus();
      loadSupabaseArticlesOnHomePage();
    });
    
    // Listen for storage changes
    window.addEventListener('storage', (e) => {
      if (e.key === 'globalUserLogin') {
        checkLoginStatus();
      }
    });
    
    onAuthStateChanged(auth, (user) => {
      // Firebase auth state change - sync with localStorage if needed
      if (!user) {
        localStorage.removeItem('globalUserLogin');
        checkLoginStatus();
      }
    });
  </script>
  <script src="script.js"></script>
</body>
</html>
